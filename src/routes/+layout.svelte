<script lang="ts">
	import Header from '$lib/client/components/Header.svelte'
	import { fetchData } from '$lib/client/fetchData'
	import { activeRequests, userData } from '$lib/client/store'
	import { LottiePlayer } from '@lottiefiles/svelte-lottie-player'
	import '../styles/global.scss'
	import { fade } from 'svelte/transition'
	import { dev } from '$app/environment'
	import { inject } from '@vercel/analytics'
	import { injectSpeedInsights } from '@vercel/speed-insights/sveltekit'

	injectSpeedInsights()

	inject({ mode: dev ? 'development' : 'production' })

	const isOpenedFromTelegram = Boolean(window.Telegram.WebView.initParams.tgWebAppThemeParams)
	let userDataLoaded = false

	fetchData('getMe').then((data) => {
		userData.set(data)
		userDataLoaded = true
	})

	fetchData('updateProfilePhoto')

	let theme = window.Telegram.WebApp.colorScheme
	$: {
		document.body.classList.toggle('dark', theme === 'dark')
		const backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--background')
		window.Telegram.WebApp.setHeaderColor(backgroundColor)
	}

	window.Telegram.WebApp.onEvent('themeChanged', () => {
		theme = window.Telegram.WebApp.colorScheme
	})
</script>

{#if isOpenedFromTelegram}
	{#if !userDataLoaded}
		<div class="loader" out:fade>
			<svg width="200" height="112.74" version="1.1" viewBox="0 0 52.917 29.829" xmlns="http://www.w3.org/2000/svg">
				<g transform="translate(-.52624 -72.972)">
					<path
						d="m26.139 72.972c-0.57941-0.0029-0.9874 0.01613-0.8361 0.04692 0.2933 0.05927 1.0562 0.17417 1.5015 0.22606 0.7359 0.08578 1.1183 0.20316 1.839 0.5646 0.58649 0.29416 0.84569 0.4889 0.77084 0.57898-0.07187 0.08664-0.23524 0.04596-0.84458-0.20994-0.86885-0.36496-1.3179-0.49672-2.1551-0.63238-0.74475-0.12071-1.3591-0.08521-2.1941 0.12682-0.27576 0.07009-0.21947 0.08394 0.48499 0.12026 1.0391 0.05353 1.8557 0.19542 2.5899 0.44975 0.67702 0.23458 1.5121 0.5133 1.8914 0.63139 0.39504 0.12301 0.57383 0.23606 0.76803 0.48583 0.07659 0.09856 0.35424 0.40048 0.61684 0.67088 0.73929 0.76126 0.93171 1.0256 0.74481 1.0235-0.09971 0-0.27252-0.14208-0.95697-0.78164-0.34684-0.32403-0.72019-0.6569-0.82982-0.73966-0.34736-0.26227-0.76587-0.42562-1.377-0.53778-0.17115-0.03138-0.34573-0.09421-0.60897-0.21889-0.48684-0.23067-0.69571-0.30721-1.1133-0.40812-0.45355-0.10963-0.81911-0.1625-1.4054-0.20337-0.57117-0.0399-0.68366-0.02254-1.4064 0.21543l-0.47155 0.15519 0.24061 0.03657c0.15354 0.02343 0.49823 0.03479 0.95349 0.0315 0.72381-0.0055 1.1402 0.02078 1.5826 0.09992 0.77843 0.13899 1.3861 0.42897 1.3861 0.66155 0 0.09536-0.0543 0.1043-0.23308 0.03807-0.48087-0.17819-0.90647-0.31251-1.1159-0.35191-0.4244-0.07994-0.96469-0.10926-1.3879-0.07548-0.59752 0.04768-0.7219 0.08191-0.94486 0.26036-0.06353 0.05088-0.22599 0.14844-0.36099 0.21683-0.13498 0.06829-0.33633 0.18846-0.44754 0.26711-0.25191 0.17807-0.72426 0.59693-0.83083 0.7369l-0.07998 0.10502 0.07998-0.03488c0.04402-0.01944 0.21331-0.11058 0.37622-0.20289 0.30413-0.17224 1.1099-0.5561 1.4598-0.69546 0.60327-0.24036 1.3723-0.30369 2.0844-0.17142 0.12705 0.02366 0.38051 0.10273 0.56316 0.17568 0.31555 0.12624 0.35004 0.13357 0.69301 0.14955 0.22046 0.01031 0.38905 0.03229 0.43315 0.05643 0.12118 0.06634 1.2683 0.83935 1.5449 1.0411 0.28522 0.20796 1.1472 0.91262 1.4834 1.2124 0.58472 0.52151 1.4538 1.7413 1.7982 2.5241 0.18797 0.42726 0.27077 0.76217 0.40287 1.629 0.0637 0.41796 0.09384 0.27932 0.07208-0.33212v0c-0.04597-1.2914-0.16503-1.7333-0.71568-2.6549-0.55042-0.92117-0.82064-1.2476-1.374-1.6602-0.21799-0.16246-0.65748-0.5057-0.97667-0.7626-0.31918-0.25692-0.78907-0.60481-1.0441-0.77318-0.51511-0.33991-0.64978-0.45611-0.63656-0.54896 0.01517-0.10527 0.20689-0.07746 0.52394 0.0758 0.36163 0.17489 0.70308 0.40851 1.1557 0.79093 0.89552 0.75632 1.0577 0.86974 1.4366 1.0045 0.07327 0.02599 0.18158 0.09566 0.24069 0.15472 0.23588 0.23569 0.61266 0.83307 1.0305 1.634 0.15851 0.30386 0.32792 0.59149 0.37631 0.63911 0.06695 0.06584 0.0805 0.07174 0.05656 0.02454-0.01731-0.03407-0.13417-0.3719-0.25978-0.7507-0.12563-0.37888-0.32218-0.90976-0.43678-1.1798-0.11461-0.26999-0.23297-0.56668-0.26307-0.65943-0.06564-0.20222-0.07313-0.48765-0.014-0.53669 0.02364-0.01964 0.04758-0.02282 0.05725-7e-3 0.0094 0.01477 0.04945 0.03324 0.08951 0.04087 0.05903 0.01108 0.06663 0.0061 0.04019-0.0254-0.01789-0.02168-0.05386-0.03961-0.07971-0.03998-0.03112 0-0.10232-0.11498-0.21101-0.33937-0.09021-0.1862-0.24129-0.44038-0.3356-0.56479-0.4063-0.53592-0.70604-0.81095-1.2322-1.1309-0.20462-0.12441-0.37159-0.25908-0.59211-0.47752-0.41695-0.41287-0.82689-0.67193-1.4628-0.9245-0.55382-0.22006-0.64519-0.23586-1.5119-0.26001-0.21685-0.0061-0.42897-0.0094-0.62207-0.01031zm-2.7005 1.9589c-0.11558-0.01633-0.38874 0.10356-0.72416 0.32663-0.10895 0.07247-0.198 0.13489-0.198 0.13876 0 0.02022 0.25764-0.05561 0.53014-0.15577 0.33637-0.12367 0.45158-0.18661 0.45158-0.24714 0-0.03659-0.02106-0.05715-0.05955-0.06248zm6.9098 0.12412c0.05658-0.0075 0.15145 0.02625 0.27796 0.10069 0.243 0.14298 0.83498 0.74335 0.98651 1.0006 0.1469 0.2493 0.18163 0.45374 0.10296 0.60588-0.07247 0.14018-0.142 0.11902-0.19874-0.0603-0.09401-0.29713-0.24903-0.50846-0.7515-1.0247-0.37769-0.38812-0.48347-0.51342-0.4763-0.56378 0.0048-0.0345 0.02513-0.05386 0.05911-0.05836zm-5.0564 0.67403c-0.24959 0.0031-0.50294 0.01652-0.65418 0.04093-0.53996 0.08756-1.1006 0.29782-1.8327 0.68733-0.38182 0.20304-0.39937 0.21673-0.85191 0.66474-0.30509 0.30209-0.43745 0.45046-0.38977 0.4371 0.03971-0.01109 0.28012-0.12371 0.5342-0.25014v0c0.25412-0.12643 0.66438-0.34576 0.91174-0.4875 0.9258-0.53026 1.4721-0.67864 2.6324-0.71492 0.54171-0.01711 0.63475-0.02656 0.67821-0.06996 0.10327-0.10329-0.07216-0.22661-0.39632-0.27862-0.13619-0.02195-0.38209-0.03109-0.63168-0.02888zm1.563 0.51066c-0.16691-0.0029-0.33114 0.02423-0.52705 0.07919-0.08736 0.02454-0.41857 0.06427-0.73612 0.08802-0.79029 0.05929-1.0904 0.10996-1.5595 0.26344-0.33178 0.10858-0.59009 0.24557-0.78385 0.41571-0.19919 0.17487-0.35701 0.25733-0.85819 0.44855-0.31767 0.12118-0.40124 0.16717-0.57749 0.31744-0.11334 0.09656-0.28251 0.26287-0.37587 0.36953-0.15832 0.18093-0.16413 0.19264-0.08716 0.17333 0.0454-0.01167 0.25245-0.10323 0.46004-0.20401 0.38621-0.18747 0.72744-0.28681 0.86609-0.25204 0.03969 0.0099 0.25066-0.01516 0.46885-0.05546 0.69233-0.12849 1.6005-0.28028 1.8695-0.31252 0.34374-0.04114 1.2942-0.01401 1.5592 0.04448 1.1174 0.24695 2.1293 1.0032 2.7209 2.0334 0.07576 0.13195 0.23166 0.38263 0.34635 0.55703 0.23604 0.35918 0.32895 0.6084 0.4014 1.077 0.02682 0.17378 0.07562 0.35599 0.12071 0.45061 0.15601 0.32751 0.11667 0.72931-0.13638 1.394-0.3384 0.8887-0.4845 1.1418-1.2062 2.0876-0.13016 0.17057-0.27827 0.38934-0.32902 0.48616-0.05079 0.0968-0.1455 0.25389-0.21055 0.34915-0.0651 0.09526-0.16415 0.26427-0.22013 0.37548-0.08694 0.17271-0.12262 0.21319-0.24518 0.27944-0.17199 0.09296-0.51011 0.18144-0.87157 0.22776-0.68461 0.08771-1.8034-0.14243-2.6051-0.53588-0.75336-0.36974-1.1975-0.78043-1.461-1.3507-0.11062-0.23944-0.2907-0.85057-0.39334-1.3351-0.09797-0.46224-0.09847-1.1473-0.0029-1.4582 0.13722-0.43877 0.38189-0.84285 0.70983-1.1726 0.48794-0.49053 1.088-0.73427 1.9223-0.78041 0.39336-0.02164 0.67885 0.01167 1.2897 0.15013 0.28016 0.06357 0.51287 0.09924 0.64628 0.09924 0.19925 0 0.21253 0.0045 0.30007 0.09717 0.24701 0.26192 0.42051 0.76946 0.42051 1.2301 0 0.29507-0.0882 1.0841-0.16011 1.4324-0.1829 0.88539-0.60148 1.4453-1.2554 1.6791-0.2745 0.09806-0.76649 0.12344-1.086 0.05606-0.53325-0.11245-1.2305-0.54412-1.6085-0.99605-0.446-0.53319-0.4729-1.4369-0.06267-2.0984 0.27806-0.44824 0.70051-0.75865 1.2458-0.91542 0.31405-0.09034 0.95522-0.09055 1.2851 0 0.44277 0.12083 0.74852 0.32959 0.90577 0.61854 0.067 0.1231 0.08528 0.19777 0.09536 0.3894l0.01224 0.23717-0.07745 0.01945c-0.14607 0.0366-0.32819-9e-3 -0.62688-0.157-0.48907-0.24251-0.82099-0.28866-1.1797-0.16405-0.28026 0.09744-0.56559 0.39302-0.63808 0.66092-0.01788 0.06603-0.02654 0.21189-0.01964 0.32412 0.02168 0.34098 0.20913 0.60806 0.53811 0.76668 0.18449 0.08902 0.51344 0.09277 0.69701 0.0078 0.37272-0.17234 0.52347-0.58322 0.32904-0.89718-0.15808-0.25517-0.48866-0.34983-0.67481-0.1932-0.07535 0.06341-0.08888 0.09351-0.08159 0.18056 0.0075 0.08987 0.01964 0.10572 0.08802 0.11358 0.04369 0.0045 0.07954-0.0044 0.07954-0.02168 0-0.05819 0.1141-0.03071 0.15935 0.03835 0.10331 0.15766-0.04387 0.33511-0.27782 0.33511-0.11379 0-0.15768-0.01555-0.23802-0.08643-0.12964-0.11371-0.1738-0.22764-0.15684-0.40404 0.01964-0.20423 0.12643-0.35177 0.32484-0.44888 0.14247-0.06969 0.18533-0.07708 0.37126-0.06517 0.25109 0.01613 0.5029 0.13561 0.69913 0.33186 0.17088 0.17096 0.22653 0.32889 0.2089 0.59298-0.01692 0.2506-0.09345 0.42821-0.26964 0.62419-0.44766 0.4979-1.2556 0.48497-1.7906-0.02888-0.4145-0.39797-0.5161-0.91833-0.27742-1.4205 0.20559-0.43255 0.63271-0.71671 1.142-0.75972 0.40023-0.03385 0.75492 0.07284 1.1995 0.36084 0.26579 0.1722 0.36651 0.15114 0.26801-0.05598-0.12114-0.25467-0.50194-0.51826-0.90058-0.62346-0.25445-0.06708-0.75906-0.06616-1.0081 0.0031-0.42278 0.11554-0.79941 0.3738-1.0235 0.70178-0.44441 0.6504-0.38646 1.4388 0.14725 2.0046 0.32521 0.3447 0.71768 0.56514 1.1559 0.64895 0.26876 0.05142 0.40204 0.05083 0.65624-0.0029 0.86313-0.182 1.3791-1.0232 1.2575-2.0498l-0.03611-0.30472 0.07567-0.05951c0.24292-0.19112 0.22606-0.66244-0.03733-1.0453-0.12122-0.17617-0.28195-0.28286-0.59077-0.39187-0.43539-0.15365-0.79035-0.21484-1.2464-0.21467-0.83289 0-1.4381 0.24041-1.9414 0.77024-0.24889 0.26202-0.41106 0.53329-0.53138 0.88915-0.07783 0.2302-0.0932 0.32327-0.10432 0.63092-0.01555 0.42963 0.04361 0.76783 0.22025 1.2614 0.08674 0.24234 0.11185 0.35486 0.11179 0.50146 0 0.30746 0.19025 0.62559 0.5702 0.95283 0.86416 0.74421 2.444 1.1167 3.3701 0.79453 0.43204-0.15017 0.67961-0.36288 1.1633-0.99946 0.16355-0.21521 0.39786-0.50756 0.52065-0.64971 0.22742-0.26312 0.4734-0.61647 0.59211-0.85034 0.08624-0.17 0.4734-1.1051 0.57986-1.4005 0.10054-0.27901 0.10885-0.60467 0.01673-0.661-0.07455-0.04551-0.11651 0.02223-0.22054 0.35693-0.08556 0.27551-0.16763 0.40202-0.23411 0.36103-0.04799-0.02967-0.01342-0.29898 0.0903-0.70048 0.09615-0.37306 0.10819-0.65445 0.04144-0.96938-0.05429-0.25636-0.12414-0.37666-0.22546-0.38856-0.11459-0.01362-0.13588 0.07526-0.13561 0.56673 0 0.23324-0.01536 0.61391-0.0342 0.84577-0.03049 0.37291-0.02893 0.44725 0.014 0.64344 0.04492 0.20423 0.04527 0.23929 0.0033 0.44099-0.14406 0.69768-0.54593 1.3882-0.83562 1.4361-0.1073 0.01769-0.12981 0.03996-0.31738 0.3117-0.34812 0.50442-0.70921 0.84724-1.0976 1.042-0.75233 0.37744-1.9217 0.23542-2.8064-0.34073-0.38045-0.24778-0.89031-0.78539-0.83297-0.87822 0.0316-0.05112 0.16022-0.03422 0.25655 0.03376 0.05007 0.0353 0.19878 0.15204 0.3305 0.25929 0.52384 0.42677 1.0255 0.64461 1.6528 0.71749 0.75933 0.08832 1.4363-0.18152 1.9033-0.75869 0.21496-0.2656 0.30274-0.47474 0.45901-1.092 0.1905-0.75241 0.24469-1.1378 0.245-1.7458 0-0.69855-0.09326-1.1803-0.35901-1.8487-0.30417-0.76488-0.83742-1.2311-1.6573-1.4487-0.26425-0.07018-0.33538-0.07667-0.83742-0.07667-0.503 0-0.57241 0.0061-0.83503 0.07684-0.15758 0.04216-0.3656 0.11383-0.46214 0.15906-0.20118 0.09421-0.77394 0.47673-1.257 0.83964-0.53677 0.40309-1.1066 1.0055-1.2858 1.3593-0.12034 0.23742-0.23563 0.78755-0.28755 1.3724-0.0099 0.11118-0.02541 0.25228-0.03447 0.31347l-0.01653 0.11132 0.06133-0.06127c0.03377-0.03385 0.12058-0.2269 0.19293-0.42907 0.23699-0.66227 0.48602-1.1144 0.86521-1.571 0.32838-0.39546 0.90389-0.84479 1.3298-1.0381 0.19242-0.08738 0.20596-0.08951 0.41542-0.06244 0.15622 0.02022 0.3454 0.01673 0.67866-0.01283 0.75204-0.06616 1.2703 0.0078 1.855 0.26488 0.28673 0.12606 0.3829 0.13347 0.3829 0.0294 0-0.10675-0.21457-0.30155-0.46854-0.42539-0.34364-0.16763-0.61222-0.2277-1.0908-0.24434-0.44208-0.01536-0.67384 0.0084-1.1047 0.11317-0.13905 0.03374-0.26081 0.05351-0.27051 0.04383-0.04786-0.04783 0.02798-0.16824 0.15204-0.24078 0.40719-0.2387 1.2631-0.30052 1.9163-0.13852 0.47838 0.11871 0.94651 0.43438 1.0914 0.73581 0.11484 0.23898 0.13776 0.5316 0.04448 0.56736-0.02222 0.0084-0.08861-0.01731-0.14774-0.05715-0.05913-0.03988-0.16965-0.08122-0.24574-0.09191-0.0761-0.0105-0.29054-0.06226-0.47645-0.11472-0.47904-0.13518-0.71825-0.17063-1.1468-0.16942-0.64173 0.0031-1.2394 0.09345-1.5632 0.23968-0.63539 0.28696-1.2695 0.97221-1.5901 1.7181-0.19511 0.45407-0.25016 0.83914-0.16905 1.1839 0.02252 0.09528 0.08087 0.39187 0.12997 0.65896 0.2388 1.2995 0.7205 2.1689 1.4849 2.6801 0.7563 0.50595 1.9878 0.93968 3.0792 1.0847 0.74848 0.09948 1.8202-0.04618 2.4628-0.3348 0.55439-0.24905 0.9629-0.6276 1.6142-1.4958 0.70596-0.94099 1.143-2.0301 1.159-2.8883 0.0042-0.23493-0.0029-0.27328-0.05491-0.3262-0.05806-0.05808-0.06214-0.0583-0.12369-0.0081-0.05013 0.04092-0.09411 0.17671-0.20777 0.6406-0.26468 1.0806-0.60572 1.7831-1.2581 2.5912-0.50926 0.63084-1.1114 1.0454-1.6301 1.1224-0.16538 0.02452-0.35401-0.04332-0.33919-0.12211 0.01224-0.06456 0.27016-0.20429 0.65357-0.35385 0.36892-0.14403 0.56636-0.27621 0.83608-0.56026 0.71212-0.7498 1.1832-1.6545 1.4927-2.8664 0.05613-0.21988 0.12818-0.49628 0.15993-0.61432 0.06868-0.25511 0.0729-0.48524 0.01536-0.81399-0.08455-0.48219-0.34744-1.1009-0.56508-1.3298-0.11226-0.11801-0.19886-0.13926-0.26097-0.0644-0.04527 0.0545-0.01555 0.17658 0.171 0.70458 0.17953 0.50782 0.24415 0.86869 0.22739 1.2705-0.04997 1.2009-0.80025 2.8064-1.7147 3.6688-0.21391 0.20172-0.36692 0.28813-0.41839 0.23666-0.04902-0.049 0.04081-0.19563 0.34005-0.55569 0.65083-0.78304 1.0162-1.4352 1.2914-2.304 0.26-0.82107 0.24819-1.2233-0.06807-2.3192-0.06234-0.21607-0.12762-0.48898-0.14519-0.6064-0.0558-0.37367-0.23678-0.68014-0.75683-1.282-0.66411-0.76861-1.5222-1.3726-2.2884-1.6109-0.40132-0.12468-0.62098-0.15037-1.2705-0.14784-0.69032 0.0033-1.067 0.04523-1.779 0.20098-0.49716 0.10872-0.62186 0.11523-0.67195 0.03525-0.04286-0.06849 0.02367-0.114 0.32858-0.22571 0.53-0.19394 1.1082-0.29498 1.9924-0.34775 0.95697-0.05722 1.3492-0.0068 1.9059 0.24234 0.80532 0.36115 1.6706 1.0488 2.478 1.9691 0.16717 0.19064 0.46741 0.50893 0.66715 0.7075 0.27732 0.27547 0.39362 0.41491 0.49172 0.58914 0.24763 0.43974 0.41485 0.93436 0.50852 1.5044 0.03171 0.19285 0.08246 0.36548 0.15282 0.51974l0.10533 0.23098-0.0029 0.40424c-0.0029 0.3515-0.01458 0.44816-0.091 0.74003-0.2116 0.80832-0.5687 1.4852-1.2281 2.3269-0.14671 0.18727-0.3594 0.46407-0.47258 0.61511-0.34226 0.45678-0.64976 0.69915-1.2515 0.98682-0.95376 0.45588-1.6393 0.51159-2.7728 0.22548-0.64399-0.16262-1.0412-0.28846-1.5828-0.50175-1.0352-0.40758-1.5195-0.68156-1.9854-1.1225-0.61218-0.57953-0.85343-1.1701-1.019-2.4939-0.05359-0.42844-0.09755-0.58686-0.16952-0.61037-0.10858-0.03536 0.06715 0.96726 0.28455 1.6234 0.36282 1.095 0.97437 1.8782 1.9287 2.4701 0.40834 0.25325 1.416 0.73917 1.7363 0.83727 0.16635 0.05095 0.49074 0.15569 0.72107 0.23277 0.74024 0.24776 1.2426 0.29447 1.828 0.16985v0c0.33939-0.0722 0.74088-0.23689 1.1875-0.48688 0.75838-0.4245 1.0679-0.67135 1.2695-1.0123 0.07778-0.13146 0.28448-0.42199 0.45932-0.64566 0.73524-0.94015 1.1318-1.6975 1.3625-2.6017 0.23256-0.91139 0.20555-1.5994-0.10208-2.5975-0.24611-0.79857-0.79136-1.6267-1.6732-2.5411-0.97394-1.0099-2.3845-2.0236-3.1172-2.2401-0.20648-0.06096-0.37616-0.09244-0.54305-0.09491zm-1.2959 1.628c-0.37915-0.0029-0.78298 0.04095-1.2091 0.12651-0.77242 0.15511-1.0894 0.28383-1.4294 0.58076-0.1191 0.10397-0.418 0.34328-0.66415 0.53166-0.53168 0.40698-0.65738 0.52044-0.76314 0.68854-0.10352 0.16458-0.25261 0.51386-0.39469 0.92514l-0.11385 0.32982 0.07862-0.08435c0.04327-0.0463 0.16088-0.19299 0.26147-0.32603 0.27044-0.35768 0.49802-0.60456 0.8019-0.87011 0.28531-0.24926 0.89129-0.71418 1.1841-0.9085 0.54325-0.36037 1.1743-0.55091 1.9343-0.58371 1.0131-0.04367 1.8268 0.24168 2.4411 0.85592 0.6753 0.67533 0.8971 1.4558 0.85625 3.0143-0.01789 0.68862-0.05232 0.92318-0.21772 1.4917-0.11737 0.40321-0.13537 0.52822-0.09118 0.63487 0.01992 0.04783 0.04622 0.08701 0.05878 0.08701 0.01224 0 0.05861-0.04224 0.10236-0.0939 0.11332-0.1336 0.34141-0.62608 0.43126-0.93124 0.0668-0.22682 0.08002-0.34248 0.10459-0.90908 0.01555-0.35708 0.02427-1.0329 0.01945-1.5016l-9e-3 -0.8523-0.09001-0.20681c-0.1414-0.3251-0.34289-0.60541-0.67325-0.93654-0.31738-0.31813-0.59594-0.5245-0.94038-0.69653-0.4831-0.24139-1.0465-0.36354-1.6784-0.36544zm-2.952 0.32228c-0.04014-0.0029-0.08837 0.0055-0.13983 0.02164-0.21624 0.07019-0.62165 0.29254-0.75103 0.41172-0.07249 0.0668-0.19313 0.2123-0.26799 0.32354-0.17471 0.25932-0.37913 0.62077-0.35113 0.62077 0.01167 0 0.17306-0.1217 0.35815-0.27048 0.18506-0.14866 0.51248-0.39039 0.72756-0.53714 0.40171-0.27398 0.53556-0.39735 0.53556-0.49349 0-0.04651-0.04445-0.07374-0.1113-0.0767z"
						style="fill-rule:evenodd;fill:#fff;paint-order:stroke fill markers;stop-color:#000000;stroke-linecap:round;stroke-linejoin:round;stroke-width:.037442"
					/>
					<g
						transform="matrix(.024855 0 0 .024855 -51.745 136.61)"
						style="fill:#2188ff;shape-inside:url(#rect11129-4-3);white-space:pre"
						aria-label="Fingerprints"
					>
						<path d="m2103-1440.7v-252.94h177.6v50.588h-111.22v51.306h102.97v50.588h-102.97v100.46z" />
						<path d="m2308.6-1440.7v-182.26h63.863v182.26zm-1.4351-208.09v-57.405h67.092v57.405z" />
						<path
							d="m2411.9-1440.7v-132.75q0-12.198-0.7176-24.756-0.7175-12.557-2.1526-24.756h61.71l3.5878 31.573h-3.9466q8.9695-17.221 25.473-26.191 16.504-9.3283 37.313-9.3283 31.932 0 47.718 19.015 16.145 18.657 16.145 58.481v108.71h-63.863v-105.84q0-17.58-6.0992-24.397-6.0993-7.1756-17.58-7.1756-15.069 0-24.397 10.046-9.3283 9.6871-9.3283 25.832v101.53z"
						/>
						<path
							d="m2724.8-1360.3q-27.267 0-48.077-5.0229-20.45-4.6641-36.954-14.71l11.122-45.206q9.687 5.7405 21.168 9.6871t23.68 5.7405q12.557 2.1527 23.68 2.1527 22.962 0 34.084-10.763 11.122-10.405 11.122-29.779v-31.931h3.5878q-5.7404 15.786-22.603 25.473-16.863 9.3283-37.313 9.3283-24.397 0-42.695-10.763-17.939-11.122-28.344-31.573-10.046-20.45-10.046-48.435 0-27.985 10.046-48.435 10.405-20.45 28.344-31.214 18.298-11.122 42.695-11.122 21.168 0 37.313 9.3283 16.145 9.3282 21.886 24.756l-2.8703-0.7176 3.9466-29.42h61.351q-1.4351 12.198-2.1527 24.756-0.7175 12.557-0.7175 24.756v118.04q0 45.924-26.191 70.321-26.191 24.756-76.061 24.756zm3.229-132.39q16.504 0 26.191-11.122 9.6871-11.122 9.6871-32.29 0-21.527-9.6871-32.29-9.687-11.122-26.191-11.122-16.863 0-26.55 11.122-9.6871 10.763-9.6871 32.29 0 21.168 9.6871 32.29 9.687 11.122 26.55 11.122z"
						/>
						<path
							d="m2962.7-1436.8q-49.512 0-77.138-25.473-27.267-25.473-27.267-69.962 0-27.626 11.481-49.153 11.481-21.527 32.29-33.366 20.809-12.198 48.794-12.198 27.626 0 45.924 12.198 18.656 11.84 27.985 33.008 9.3283 20.809 9.3283 48.435v13.634h-122.34v-30.138h75.344l-6.0992 5.0229q0-20.45-7.8932-30.138-7.5344-10.046-21.527-10.046-16.145 0-24.756 12.199-8.252 11.84-8.252 35.878v6.458q0 24.038 11.84 35.16 11.84 11.122 34.084 11.122 14.351 0 26.908-3.229 12.916-3.229 24.397-10.405l16.504 41.618q-13.634 9.3282-31.573 14.351-17.939 5.0229-38.031 5.0229z"
						/>
						<path
							d="m3064.6-1440.7v-132.39q0-12.557-0.7175-25.115-0.7176-12.557-2.1527-24.756h61.71l6.8168 55.97h-9.6871q3.5878-20.45 11.481-33.725 7.8931-13.275 19.733-19.733 11.84-6.458 27.985-6.458 7.5344 0 11.122 0.7175 3.9466 0.3588 8.2519 2.1527v55.97q-8.9695-3.9466-14.351-5.0229-5.3817-1.0764-13.992-1.0764-14.71 0-24.038 5.3817-9.3283 5.023-13.634 15.786-3.9466 10.763-3.9466 27.626v84.672z"
						/>
						<path
							d="m3218.5-1363.2v-210.25q0-12.198-0.7175-24.756-0.7176-12.557-2.1527-24.756h61.71l3.9465 32.29h-3.5878q5.023-16.145 22.244-26.191 17.221-10.046 38.39-10.046 23.679 0 41.618 11.481 17.939 11.122 27.985 32.649 10.405 21.168 10.405 50.947 0 29.42-10.405 50.947-10.046 21.527-27.985 33.008-17.939 11.122-41.618 11.122-20.809 0-37.672-9.3283-16.863-9.6871-22.244-25.473h3.9466v108.35zm99.382-120.91q16.504 0 26.191-11.122 10.046-11.481 10.046-36.596t-10.046-36.237q-9.687-11.481-26.191-11.481-16.145 0-26.191 11.481-10.046 11.122-10.046 36.237t10.046 36.596q10.046 11.122 26.191 11.122z"
						/>
						<path
							d="m3449.5-1440.7v-132.39q0-12.557-0.7175-25.115-0.7176-12.557-2.1527-24.756h61.71l6.8169 55.97h-9.6871q3.5878-20.45 11.481-33.725 7.8931-13.275 19.733-19.733 11.84-6.458 27.985-6.458 7.5344 0 11.122 0.7175 3.9466 0.3588 8.2519 2.1527v55.97q-8.9695-3.9466-14.351-5.0229-5.3817-1.0764-13.992-1.0764-14.71 0-24.038 5.3817-9.3282 5.023-13.634 15.786-3.9466 10.763-3.9466 27.626v84.672z"
						/>
						<path d="m3603.4-1440.7v-182.26h63.863v182.26zm-1.4351-208.09v-57.405h67.092v57.405z" />
						<path
							d="m3706.8-1440.7v-132.75q0-12.198-0.7176-24.756-0.7175-12.557-2.1527-24.756h61.71l3.5878 31.573h-3.9466q8.9695-17.221 25.473-26.191 16.504-9.3283 37.313-9.3283 31.931 0 47.718 19.015 16.145 18.657 16.145 58.481v108.71h-63.863v-105.84q0-17.58-6.0992-24.397-6.0993-7.1756-17.58-7.1756-15.069 0-24.397 10.046-9.3283 9.6871-9.3283 25.832v101.53z"
						/>
						<path
							d="m4023.6-1436.8q-38.748 0-58.481-18.298-19.374-18.657-19.374-56.328v-64.58h-34.084v-47h34.084v-43.054l63.863-15.069v58.122h44.489v47h-44.489v62.069q0 15.786 7.1756 21.168 7.1756 5.0229 17.222 5.0229 6.0992 0 10.405-0.7175 4.6641-1.0764 9.687-2.8703v49.153q-7.8931 3.229-15.786 4.3053-7.5344 1.0764-14.71 1.0764z"
						/>
						<path
							d="m4148.8-1436.8q-25.473 0-46.283-5.0229-20.45-5.3817-34.802-14.351l15.428-41.618q13.992 7.8931 31.214 12.916 17.58 5.0229 34.802 5.0229 13.634 0 19.733-3.9466 6.458-4.3054 6.458-11.122 0-5.3817-3.9466-8.6107-3.9465-3.229-11.84-4.6641l-38.748-6.8169q-22.962-4.3053-35.878-16.863-12.557-12.916-12.557-33.367 0-18.656 10.046-32.29 10.046-13.992 28.702-21.527 18.657-7.8931 44.13-7.8931 20.809 0 39.466 4.6641 19.015 4.6642 33.008 14.71l-16.504 40.542q-11.122-7.5343-26.191-12.198-14.71-5.0229-27.626-5.0229-15.428 0-21.886 4.6641-6.458 4.3054-6.458 10.763 0 5.023 3.5878 8.6108 3.5878 3.229 11.481 4.6641l38.748 6.8168q23.68 3.9466 36.237 16.504 12.916 12.198 12.916 33.366 0 19.733-10.763 33.725-10.405 13.634-29.061 21.168-18.657 7.1756-43.412 7.1756z"
						/>
					</g>
				</g>
			</svg>
		</div>
	{/if}
	<Header />
	<main>
		<slot />
	</main>
{:else}
	<div class="error">
		<LottiePlayer src="/animations/flame/no.json" autoplay loop width={192} />

		<span>Something went wrong. Make sure you've opened this app from Telegram.</span>
	</div>
{/if}

<style lang="scss">
	.error {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 2rem;
		height: 100vh;
		font-size: 1.5rem;
		text-align: center;
		max-width: 24rem;
		margin: 0 auto;
		text-wrap: balance;
		line-height: 1.35;
	}

	.loader {
		position: fixed;
		z-index: 100;
		left: 0;
		top: 0;
		width: 100%;
		height: var(--tg-viewport-height);
		background: var(--background);
		display: flex;
		align-items: center;
		justify-content: center;

		svg path {
			animation: loading 3s infinite;
		}
	}

	@keyframes loading {
		50% {
			fill: var(--background-secondary);
		}

		75% {
			fill: var(--background);
		}

		100% {
			fill: var(--background-secondary);
		}
	}
</style>
